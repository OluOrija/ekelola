---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getAllPosts } from "../../lib/content";
const posts = await getAllPosts();
const grouped = posts.reduce((acc, post) => {
  const year = new Date(post.data.date).getFullYear();
  const month = new Date(post.data.date).getMonth() + 1;
  acc[year] = acc[year] || {};
  acc[year][month] = acc[year][month] || [];
  acc[year][month].push(post);
  return acc;
}, {});
---
<BaseLayout title="Archive">
  <h1>Archive</h1>
  {Object.entries(grouped).map(([year, months]) => (
    <section>
      <h2>{year}</h2>
      {Object.entries(months).map(([month, posts]) => (
        <div>
          <h3>{month}</h3>
          <ul>
            {posts.map((post) => (
              <li>{post.data.title}</li>
            ))}
          </ul>
        </div>
      ))}
    </section>
  ))}
</BaseLayout>
